Phase 1: Security Foundation (Critical First Step)
Prompt 1.1 - Implement Firestore Security Rules

I need comprehensive Firestore security rules before migrating from Express to client-side Firebase.

Create a complete firestore.rules file for these collections:
- products (public read, admin-only write)
- categories (public read, admin-only write)  
- parentCategories (public read, admin-only write)
- adminStats (admin-only read/write)

Requirements:
1. Public users can read all products and categories
2. Only authenticated users with custom claim admin: true can write
3. Validate required fields (name, price must exist and be valid)
4. Prevent price manipulation (price must be positive number)
5. Include comprehensive error messages

Provide the complete firestore.rules file with detailed comments.
Phase 2: Data Service Layer
Prompt 2.1 - Product Firestore Service

Create a complete client-side Firestore service to replace all /api/products endpoints.

File: src/services/productFirestoreService.ts

Required functions:
- getAllProducts(filters?: {category?, search?, sortBy?, limit?, startAfter?})
- getProductById(productId: string)
- getProductsByCategory(categoryId: string)
- searchProducts(searchTerm: string)
- createProduct(productData) - admin only
- updateProduct(productId: string, updates) - admin only  
- deleteProduct(productId: string) - admin only

Requirements:
1. Use TypeScript with proper interfaces
2. Include pagination support with Firestore cursors
3. Handle all error cases with descriptive messages
4. Use the db instance from existing firebase config
5. Include client-side validation before writes
6. Return the same data structure as current API

Do not modify any components yet - just create the service.
Prompt 2.2 - Category Firestore Service

Create a client-side Firestore service to replace all category API endpoints.

File: src/services/categoryFirestoreService.ts

Required functions:
- getAllCategories()
- getAllParentCategories()  
- getCategoriesByParent(parentId: string)
- getCategoryById(categoryId: string)
- createCategory(categoryData) - admin only
- updateCategory(categoryId: string, updates) - admin only
- deleteCategory(categoryId: string) - admin only

Requirements:
1. Handle parent-child category relationships
2. Include validation to prevent deleting categories with products
3. Maintain the same data structure as current API
4. Use TypeScript with proper error handling
5. Use the db instance from firebase config

Do not modify components yet - just create the service.
Phase 3: Component Migration
Prompt 3.1 - Convert Admin Products Page

Convert the admin Products page from API calls to Firestore service.

Current file: admin/Products.tsx

Refactor to:
1. Import productFirestoreService instead of making API calls
2. Replace all fetch/axios calls to /api/products with service functions
3. Use getAllProducts() for the product list
4. Use deleteProduct() for delete operations
5. Maintain all existing UI, filtering, and search functionality
6. Keep the same loading and error states
7. Preserve pagination behavior

Only modify this single file - don't change other components yet.
Prompt 3.2 - Convert ProductForm Component

Convert the ProductForm component from API calls to Firestore service.

Current file: admin/ProductForm.tsx

Refactor to:
1. Replace POST /api/products with createProduct() from productFirestoreService
2. Replace PATCH /api/products/:id with updateProduct()
3. Replace GET /api/products/:id with getProductById() for edit mode
4. Maintain all form validation and error handling
5. Keep integration with Cloudinary image uploads
6. Preserve the same user interface and experience

Only modify this ProductForm component.
Prompt 3.3 - Convert ManageCategories Page

Convert the ManageCategories admin page from API calls to Firestore service.

Current file: admin/ManageCategories.tsx

Refactor to:
1. Replace all /api/categories calls with categoryFirestoreService functions
2. Replace /api/parent-categories calls with getAllParentCategories()
3. Use createCategory(), updateCategory(), deleteCategory() for mutations
4. Maintain parent-child category relationships in the UI
5. Keep all existing functionality and user experience

Only modify this ManageCategories component.
Phase 4: Admin Dashboard Migration
Prompt 4.1 - Admin Stats Service

Create a service to replace /api/admin/stats with Firestore aggregation.

File: src/services/adminStatsService.ts

Implement getAdminStats() function that:
1. Uses Firestore count() aggregation to get total products
2. Uses Firestore count() aggregation to get total categories  
3. Calculates other relevant statistics
4. Returns data in the same format as current /api/admin/stats

Note: Use getCountFromServer() to minimize read costs.
Include proper error handling and TypeScript types.
Prompt 4.2 - Convert Admin Dashboard

Convert the Admin Dashboard from API calls to Firestore service.

Current file: admin/Dashboard.tsx

Refactor to:
1. Replace /api/admin/stats call with getAdminStats() from adminStatsService
2. Display the same statistics and visualizations
3. Maintain all existing charts and UI elements
4. Keep loading and error states
5. Add a refresh button to recalculate stats on demand

Only modify this Dashboard component.
Phase 5: Public Pages Migration
Prompt 5.1 - Convert Public Product Pages

Convert public product listing and detail pages from API calls to Firestore service.

Files to update:
- Main product listing/feed page
- Individual product detail page
- Category browsing pages

Refactor to:
1. Replace all /api/products calls with productFirestoreService functions
2. Replace all /api/categories calls with categoryFirestoreService functions
3. Implement client-side filtering and search using Firestore queries
4. Maintain pagination using Firestore cursors
5. Keep all existing UI and user experience
6. Preserve SEO-friendly URLs and metadata

Update one component at a time, testing after each change.
Phase 6: Final Verification and Cleanup
Prompt 6.1 - Complete Dependency Check

Perform a final verification that no components still use the Express backend.

Search the entire client/src directory for:
1. Any imports of API utility functions
2. Any fetch() or axios calls to /api/ endpoints  
3. Any references to localhost:5000 or backend URLs
4. Any remaining apiRequest() function calls

Provide a complete list of files that still reference the backend.
If none are found, confirm it's safe to proceed with server removal.
Prompt 6.2 - Server Cleanup

I've verified the app works entirely without the Express backend.

Help me safely remove the server dependencies:

1. Which npm packages to uninstall (express, cors, helmet, pg, etc.)
2. Which files and folders can be safely deleted
3. Which package.json scripts to remove or update
4. Which environment variables are no longer needed
5. How to update documentation to reflect serverless architecture

Provide step-by-step removal instructions with verification after each step.