You are a senior full‑stack engineer and technical SEO expert.

I have an e‑commerce SPA called PakCart, built with:

React 18 + Vite (TypeScript)
Tailwind CSS + shadcn/ui
Routing: wouter
State: TanStack Query v5 + Zustand
Backend: Firebase Firestore (products, categories, orders, etc.)
Auth: Firebase Auth
Hosting: Vercel, as a static SPA (built with Vite)
Production domain:
https://pakcart.store

I want to implement the “dynamic sitemap endpoint” approach so that new products and categories are automatically reflected in the sitemap without manually editing sitemap.xml.

What I need from you
Architecture explanation (short but clear)

Explain how to build a dynamic sitemap on Vercel for a Vite SPA:
Using a Vercel Serverless Function or Edge Function that responds at /sitemap.xml
Fetching live data from Firestore (categories and products collections)
Returning valid XML with Content-Type: application/xml
Explain how search engines (Google/Bing) will read this and how it updates automatically when new products are added in Firestore.
Assumptions about Firestore data model
Assume a simple data model like:

Collection: categories
Fields: slug (string), name (string), isActive (boolean)
Collection: products
Fields: slug (string), name (string), categorySlug (string), isActive (boolean), updatedAt (timestamp)
Only documents with isActive === true should be included in the sitemap. If needed, you can add simple, reasonable assumptions, but keep it generic and easy to adapt.
Dynamic sitemap rules

Design the sitemap for this URL structure:

Home:
/
Category pages:
/category/[categorySlug]
e.g., /category/electronics
Product pages:
/product/[productSlug]
e.g., /product/smartphone-x10
Informational static pages (hard-coded, not from Firestore):
/about
/contact
/faq
/shipping-returns
Do NOT include in sitemap:

Admin or dashboard URLs (e.g., /admin, /admin/products, /admin/orders)
Private/account URLs (e.g., /account, /orders, /profile)
Cart/checkout URLs (e.g., /cart, /checkout)
Any auth-only or session-specific URLs
Sitemap XML details:

Root tag:
Copy<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
For each <url>:
<loc>: Full URL, e.g., https://pakcart.store/product/smartphone-x10
<lastmod>:
For dynamic docs (categories, products): Use Firestore updatedAt (ISO 8601 string). If not available, fallback to createdAt or server time.
For static pages: Use a hard-coded date placeholder I can change later.
<changefreq>:
/: daily
Category pages: daily or weekly
Product pages: weekly or monthly
Static info pages: monthly or yearly
<priority>:
/: 1.0
Category pages: 0.8
Product pages: 0.6
Static info pages: 0.5
Concrete implementation for Vercel

I’m using a Vite SPA, but I can add a Vercel serverless function via a api/ folder in the project or via a separate vercel project structure.

Provide:

A. Folder/file layout suggestion

For example:

/api/sitemap.ts (Vercel Serverless Function)
Or /api/sitemap/index.ts
And any needed config (e.g., vercel.json rewrites to map /sitemap.xml → /api/sitemap)
B. Full TypeScript code for the Vercel Serverless Function

Use firebase-admin OR the Firebase Web SDK (whichever is more appropriate for serverless functions on Vercel; explain which and why).
Initialize Firestore safely:
Show how to read credentials/config from environment variables.
Make sure initialization is not repeated on every request (use a cached singleton pattern if needed).
Query:
categories collection where isActive == true
products collection where isActive == true
Construct URLs using https://pakcart.store.
Generate a single XML string with:
Home page
Static informational pages
Each active category URL
Each active product URL
Return:
status: 200
Headers: Content-Type: application/xml
Body: the XML string
Example (for the response part only, you can improve):

Copyreturn new Response(xml, {
  status: 200,
  headers: {
    "Content-Type": "application/xml; charset=utf-8",
    "Cache-Control": "public, s-maxage=3600, stale-while-revalidate=86400"
  }
});
Make the code copy-paste ready, with:

Clear TODO: comments where I should put my own Firebase credentials or adjust collection names/fields.
Minimal error handling (log and fallback gracefully, but still return a valid XML with at least the static URLs if Firestore fails).
Vercel config (rewrite to /sitemap.xml)

Provide a small vercel.json config example that:

Rewrites requests to /sitemap.xml so they hit the function /api/sitemap
Leaves all other routes as-is for the SPA
Example (adjust as needed):

Copy{
  "rewrites": [
    {
      "source": "/sitemap.xml",
      "destination": "/api/sitemap"
    }
  ]
}
Explain where to place this file and how Vercel will pick it up.

SEO/checklist explanation

Finish with a short checklist (bullet points) for me to follow after deploying:

Where to upload/commit the function file
How to verify https://pakcart.store/sitemap.xml works in the browser
How to submit it to Google Search Console
How often Google will re-fetch it and why new products will now appear automatically
Use https://pakcart.store as the base URL in all code and XML examples.

Output:

Short explanation (architecture + flow)
TypeScript code for the Vercel Serverless Function (/api/sitemap.ts)
vercel.json example for the rewrite
Final short checklist for deployment & SEO
