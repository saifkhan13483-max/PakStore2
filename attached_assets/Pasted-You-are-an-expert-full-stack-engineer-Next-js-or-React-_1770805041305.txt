You are an expert full‑stack engineer (Next.js or React/Vite, Firebase v9, Firestore, Vercel).

My ecommerce site has a checkout flow: Cart → Information → Payment → Confirmation.

On the Payment step, when the user clicks “Complete Order” with Cash on Delivery (COD) selected, a red toast appears:

Error – No response received from the server. Please try again.

The order is not created in Firestore and does not show up in the admin orders panel.

I want you to debug and completely fix this behaviour.

Project context
Frontend: Next.js App Router or React with Vite (please detect from the repo).
Styling: Tailwind CSS + Shadcn/UI.
Authentication: Firebase Authentication v9+.
Database: Firestore.
Hosting: Vercel.
Repo URL: <REPO_URL>
Project root in Replit (if not /): <PROJECT_PATH>
Please follow these steps, explaining in words what you’re doing (code changes should be made directly in the repo, not pasted back to me):

1. Understand the current setup
Detect whether this is:

Next.js App Router,
Next.js pages router, or
React + Vite with a separate backend.
Locate and list the key files related to:

The Payment step page/component that renders the “Complete Order” button.
The function that runs when “Complete Order” is clicked.
Any backend/API route that is supposed to handle order creation.
The admin panel pages/components that show orders and order details.
Firebase / Firestore configuration.
Tell me which specific files you will be modifying.

2. Trace the “Complete Order” request
In the Payment step component, inspect the click handler for the “Complete Order” button and describe:

Which URL it calls (for example, an /api/... route).
Which HTTP method it uses.
What information it sends (user ID, cart items, totals, shipping address, payment method, etc.).
How it currently handles responses and under what condition it shows the message
“No response received from the server. Please try again.”
Use the browser’s Network tab and console to determine:

Whether the request actually leaves the browser.
If a response is received:
The HTTP status code.
Any response headers or body.
If no response is received at all (for example, the request is blocked or fails at network level).
Add temporary logging (in the code) so that:

The payload being sent is logged.
Any fetch/axios errors are logged clearly in the console.
Any unexpected behaviour (like aborted requests) is visible.
Summarise what you find:
Is the problem that the request never reaches a server, that it hits a 404, that the handler crashes, or something else?

3. Inspect and repair the backend order handler
Find the backend route that should handle this order request:

For example, a Next.js API route or serverless function that receives the order data.
Describe how this handler currently:

Reads the incoming request (including how it parses the body).
Validates the input.
Writes the order and its items to Firestore.
Sends a response back to the client.
Identify why the client ends up with “No response received from the server”. Possible causes include:

The frontend is calling a URL that doesn’t correspond to any deployed route.
The handler throws an exception before returning a response (for example due to a misconfigured import or environment variable).
The handler never sends a response on certain branches (e.g., missing return).
Vercel or the dev server is misconfigured so that the route is not available.
Use server logs and Replit logs to see the real error if the route is crashing.

Fix the handler so that:

The URL it is mounted at matches exactly what the frontend calls.
It always returns a clear JSON response for every code path (success, validation error, server error), including:
A success flag,
A human‑readable message,
The created order ID on success.
All exceptions are caught and turned into JSON error responses instead of terminating the request silently.
4. Align the frontend handler with the backend contract
Update the frontend “Complete Order” handler so that it:

Calls the correct backend URL with the correct method.
Sends all required data taken from the checkout state (user, cart, totals, shipping, payment method).
Correctly interprets the JSON response structure you defined in the backend.
Adjust the error‑handling logic so the different cases are clearly separated:

True network error / no response at all → show a message like “No response received from the server”.
Server responded with error JSON (for example, validation failed) → show the specific message from the server.
Success → clear the cart, show a success message, and optionally redirect to an order‑confirmation page.
Confirm, by retesting, that:

For a valid checkout, the “Complete Order” call now returns a proper JSON response.
The user‑facing error “No response received from the server. Please try again.” no longer occurs in normal circumstances.
5. Verify Firestore writes and rules
After fixing the request/response flow, place a test order and check Firestore:

Confirm that an order document is actually created in the intended collection.
Confirm that any order items (line items) are created as intended, either in a subcollection or another collection.
If Firestore writes are failing due to security rules:

Identify the exact rule that is denying the write.
Update the Firestore rules so authenticated users are allowed to create orders and associated items, while keeping access appropriately restricted.
Clearly state what changes you made to the rules.
6. Connect the admin panel to the real order data
Examine the admin panel’s orders list and order‑details screens:

Which collections and fields are they currently querying?
Do these paths and field names match the actual data written by the checkout flow?
Update the admin queries and data mapping so that:

They read from the same collection and schema that the backend uses for order creation.
Each placed order appears in the admin orders list.
The order‑details view shows:
Order ID,
Customer identifier,
Status,
Payment method,
Shipping address,
Subtotal, shipping, total,
List of ordered items with their quantities and prices.
Verify that, after successfully placing an order:

It is immediately visible in the admin orders list.
Its details are correct and complete.
7. Admin access control and final checks
Identify how admin users are determined in this project (for example custom claims, Firestore role documents, or a hard‑coded list).

Ensure:

Regular users can only see their own orders where applicable.
Admins can see all orders in the admin interface.
Confirm that Firestore rules enforce this, and describe any assumptions you relied on (such as certain custom claims needing to be set).

Perform a full end‑to‑end test and describe the outcome:

Sign in as a normal user.
Place an order through the full checkout flow.
Observe the network request and response for “Complete Order”.
Confirm the order appears in Firestore.
Confirm it appears in the admin panel with correct details.
Finally, provide me with a short, high‑level explanation (no code) that summarizes:

The root cause of the “No response received from the server. Please try again.” error.
The key changes you made to the frontend, backend, Firestore rules, and admin panel.
Any manual steps I still need to perform (for example: configuring environment variables, redeploying Firestore rules, setting admin claims, or redeploying to Vercel).